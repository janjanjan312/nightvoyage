<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Psi2.svg/1200px-Psi2.svg.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>夜航船 - 荣格心理学解析工具</title>
    <script type="importmap">
{
  "imports": {
    "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.1/client",
    "react-dom": "https://aistudiocdn.com/react-dom@^19.2.1",
    "react/": "https://aistudiocdn.com/react@^19.2.1/",
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/"
  }
}
</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Noto+Serif+SC:wght@200;300;400;500;600;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <style>
      :root {
        /* Classic Theme Colors */
        --bg: #0c0f14;
        --card: #151922;
        --text: #e8ecf3;
        --muted: #8b9bb4;
        --primary: #6aa7ff;
        --primary-700: #4b86db;
        --accent: #f3c98b;
        --chat-gap: 140px;
        --mystic-gold: #F7E396;
        --projection-blue: #AAC4F5;
        --imagination-green: #D2DCB6;
        --archetype-parchment: #FFF1D5;
        --active-glow: #FFFFFF;
        --error-red: #d46a6a;
        --error-glow: rgba(212, 106, 106, 0.3);

        /* Night Sea Theme Colors (Scheme 1) */
        --alchemy-gold: #D4AF37;       
        --alchemy-gold-light: #F9E5BC; 
        --lapis-lazuli: #1B2F4A;       
        --obsidian: #05070A;           
        --obsidian-glass: rgba(5, 7, 10, 0.85);
        --sea-foam: rgba(106, 167, 255, 0.1);
        
        /* Realistic Ocean Colors - DARK & SUBTLE */
        --water-deep: #020408;  /* Almost black */
        --water-mid: #0a1525;   /* Very dark navy */
        --water-electric: #152b45; /* Subtle highlight */
        
        /* Liber Novus Theme Colors (Scheme 2) */
        --liber-bg: #2C0505;           
        --liber-bg-gradient: radial-gradient(circle at center, #3a0d0d 0%, #1a0202 70%, #000000 100%);
        --liber-parchment: #E8DCCA;    
        --liber-ink: #1F1A17;          
        --liber-gold: #C5A059;         
        --liber-crimson: #800000;
        --liber-card-bg: #1a0b0b;

        /* Typography */
        --font-serif: 'Noto Serif SC', 'Songti SC', 'SimSun', serif;
      }

      * { box-sizing: border-box; }
      html { height: 100%; }
      body {
        margin: 0;
        font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
        color: var(--text);
        background-color: #000000; /* Fallback color */
        min-height: 100vh;
        overflow-x: hidden; 
        /* Optimization: Moved gradient to .fixed-background div to improve scroll performance */
      }
      body.lock-scroll { overflow: hidden; }

      /* Optimized Fixed Background Layer */
      .fixed-background {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        z-index: -1;
        background-image: linear-gradient(to bottom, #000000 0%, #020408 85%, #0d1e35 100%);
        transition: background-image 1s ease;
        pointer-events: none;
      }

      /* THEME SWITCHING */
      body[data-theme='LIBER_NOVUS'] .fixed-background {
        background-image: var(--liber-bg-gradient);
      }
      body[data-theme='LIBER_NOVUS'] {
        color: var(--liber-parchment);
      }
      body[data-theme='LIBER_NOVUS'] .star-field {
        display: none; /* Hide canvas stars in Liber Novus */
      }
      body[data-theme='LIBER_NOVUS'] .ocean-perspective {
        display: none; /* Hide ocean in Liber Novus */
      }

      #root {
        position: relative;
        z-index: 2;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      
      /* New Star Field Styles (Canvas) */
      .star-field {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        z-index: 5; /* Higher than background, lower than content */
        pointer-events: none;
      }

      /* --- Common Layout & UI --- */
      .section {
        width: 100%;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding-top: 40px;
        padding-bottom: 40px; 
        position: relative;
        /* Z-INDEX: 10 ensures content is above stars (5) and ocean (0 inside root) */
        z-index: 10;
      }

      /* Container Logic */
      .section.splash .container {
        /* WIDE LAYOUT FOR SPLASH SCREEN 1 */
        max-width: 95vw; 
        padding: 0; /* Remove padding to let screen 1 use full width */
      }

      .container {
        width: 100%;
        max-width: 680px; 
        padding: 0 24px;
        display: flex;
        flex-direction: column;
        gap: 32px;
      }
      
      /* WIDER CONTAINER FOR ATLAS */
      .container.wide {
        max-width: 1200px;
      }

      .splash {
        justify-content: flex-start;
        /* RESET padding to allow internal screens to manage height */
        padding-top: 0 !important;
        padding-bottom: 0 !important;
      }

      .splash-inner {
        text-align: center;
        animation: fadeIn 1.2s ease-out;
        width: 100%;
      }

      /* INTRO SCREENS LOGIC */
      .intro-screen {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .intro-screen-1 {
        min-height: 100vh;
        padding-top: 40px; /* Slight buffer for visual balance */
      }

      .intro-screen-2 {
        min-height: 100vh;
        padding-bottom: 120px; /* Generous bottom padding */
        justify-content: flex-start; /* Changed from center to flex-start to prevent jump */
        padding-top: 22vh; /* Use padding to position content visually in center initially */
        transition: padding 0.5s ease;
      }

      .scroll-down-indicator {
        position: absolute;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.3s;
        z-index: 10;
      }
      .scroll-down-indicator:hover {
        opacity: 1;
      }
      .scroll-down-indicator i {
        font-size: 1.2rem;
        color: #FFFFFF;
        /* Glow Effect */
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.4);
        /* Slower Animation: 4s instead of 2s */
        animation: bounce 4s infinite ease-in-out;
      }
      .scroll-text {
        font-family: 'Cinzel', serif;
        font-size: 0.75rem;
        letter-spacing: 2px;
        color: #FFFFFF;
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        opacity: 0.9;
      }
      
      @keyframes bounce {
        0%, 100% { transform: translateY(0); opacity: 0.5; }
        50% { transform: translateY(12px); opacity: 1; }
      }

      @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

      /* Animation for loading dots */
      @keyframes dotUp {
        0%, 100% { transform: translateY(0); opacity: 0.6; }
        50% { transform: translateY(-5px); opacity: 1; }
      }

      .headline {
        font-family: var(--font-serif);
        font-weight: 200;
        font-size: clamp(2rem, 6vw, 4rem); 
        letter-spacing: clamp(0.3rem, 1.5vw, 1rem); 
        margin: 0;
        color: var(--text);
      }

      /* Special White Variant for Night Sea */
      .headline.gold {
        color: #FFFFFF;
        text-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
        background: none;
        -webkit-background-clip: border-box;
        -webkit-text-fill-color: initial;
      }
      
      .headline span {
        display: inline-block;
        animation: floatChar var(--duration) ease-in-out infinite;
        animation-delay: var(--delay);
      }
      
      @keyframes floatChar {
        0%, 100% { transform: translateY(0); opacity: 0.85; }
        50% { transform: translateY(-8px); opacity: 1; }
      }

      .headline-english-subtitle {
        font-family: 'Cinzel', serif;
        font-size: clamp(0.75rem, 1.5vw, 1rem);
        color: var(--muted);
        letter-spacing: clamp(0.15rem, 0.8vw, 0.4rem);
        margin-top: 0.5rem;
        text-transform: uppercase;
        opacity: 0.8;
      }

      .headline-english-subtitle span {
        display: inline-block;
        animation: floatChar var(--duration) ease-in-out infinite;
        animation-delay: var(--delay);
      }

      .headline-subtitle {
        font-family: var(--font-serif);
        font-size: 1rem;
        color: var(--muted);
        margin-top: 2.5rem; 
        letter-spacing: 2px;
      }

      .headline-subtitle span {
        display: inline-block;
        animation: floatChar var(--duration) ease-in-out infinite;
        animation-delay: var(--delay);
      }

      /* Intro Floating Cards - UPDATED */
      .intro-showcase {
        display: flex;
        justify-content: center; /* Center alignment */
        gap: 28px; /* Card spacing */
        margin-top: 56px;
        margin-bottom: 60px; 
        perspective: 1000px;
        flex-wrap: nowrap; /* Do not wrap */
        width: 100%;
        
        /* Scrollable Horizontal Container */
        overflow-x: auto;
        padding: 25px 2vw; /* Padding for float effect and scroll safety */
        
        /* Hide Scrollbar */
        scrollbar-width: none;
        -ms-overflow-style: none;
        
        /* UX */
        -webkit-overflow-scrolling: touch;
      }
      
      .intro-showcase::-webkit-scrollbar { 
        display: none; 
      }

      .intro-card {
        width: 200px; /* Adjusted width */
        height: 310px; 
        position: relative;
        cursor: pointer;
        animation: floatCard 6s ease-in-out infinite;
        z-index: 5;
        flex-shrink: 0; /* Prevent shrinking in flex row */
      }
      
      /* Animation delays are now handled inline by React component */

      .intro-card-inner {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
        border-radius: 12px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.45);
      }

      /* CHANGED: FLIP ON HOVER */
      .intro-card:hover .intro-card-inner {
        transform: rotateY(180deg);
      }

      .intro-card-front, .intro-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: 12px;
        overflow: hidden; /* Clips the extended overlay */
      }

      .intro-card-front {
        background-color: #0c0f14; 
        /* NO BORDER - use inset shadow instead */
        border: none;
        box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1); /* Inner border to prevent edge bleeding */
      }
      
      .intro-card-overlay {
        position: absolute;
        /* Match Mind Atlas Overlay: slightly larger than container to cover anti-aliasing artifacts */
        bottom: -2px; left: -2px; right: -2px;
        height: 100%; 
        
        /* Updated Gradient: Match Mind Atlas exactly */
        background: linear-gradient(to top, #000000 0%, rgba(0,0,0,0.6) 30%, rgba(0,0,0,0) 55%);
        
        transition: opacity 0.3s;
        z-index: 1;
        pointer-events: none;
      }
      
      .intro-card:hover .intro-card-overlay {
        opacity: 0.9;
      }

      .intro-card-content {
        position: absolute;
        bottom: 28px;
        left: 0;
        width: 100%;
        text-align: center;
        z-index: 2;
        padding: 0 16px;
      }

      .intro-card-content h3 {
        font-family: var(--font-serif);
        font-size: 1.2rem;
        color: var(--active-glow);
        margin: 0 0 6px 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
      }
      
      .intro-card-content span {
        font-family: var(--font-serif);
        font-size: 0.85rem;
        color: rgba(255,255,255,0.9);
        text-transform: uppercase;
        letter-spacing: 1.5px;
        text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        font-weight: 500;
      }

      .intro-card-back {
        background: #151922;
        transform: rotateY(180deg);
        border: 1px solid rgba(255,255,255,0.15);
        display: flex;
        flex-direction: column;
        justify-content: center; /* Center vertically */
        align-items: center; /* Center the P element itself, but P text is left-aligned */
        padding: 18px 20px;
        text-align: left; /* Left align text */
        overflow-y: auto; /* Allow scroll if text overflows */
        scrollbar-width: none;
      }
      
      .intro-card-back::-webkit-scrollbar { 
        display: none; 
      }
      
      .intro-card-back p {
        font-size: 0.9rem;
        line-height: 1.5;
        color: rgba(255,255,255,0.9);
        margin: 0;
        font-family: "Noto Serif SC", serif;
        white-space: pre-wrap; /* Allow newlines */
        text-align: justify; /* Justify align for better look */
        width: 100%;
      }

      @keyframes floatCard {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-12px); }
      }
      
      .section-divider {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin: 40px 0 20px;
        color: rgba(255, 255, 255, 0.85); /* Lighter */
        font-family: var(--font-serif);
        font-size: 1.2rem; /* Larger */
        letter-spacing: 2px;
      }
      
      /* Removed ::before and ::after */

      /* Mode Cards */
      .mode-selection-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 40px; 
        width: 100%;
        margin-top: 20px;
        
        /* CONSTRAINED WIDTH FOR SCREEN 2 */
        max-width: 1100px;
        margin-left: auto;
        margin-right: auto;
        padding-left: 24px;
        padding-right: 24px;
      }

      .mode-card {
        background: rgba(21, 25, 34, 0.85);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        padding: 36px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        position: relative;
        overflow: hidden;
        min-height: 260px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .mode-card:hover {
        background: rgba(21, 25, 34, 0.95);
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-6px);
      }
      .mode-card.active {
        border-color: var(--active-glow);
        box-shadow: 0 0 25px rgba(255, 255, 255, 0.15);
      }
      
      .mode-card .card-icon-wrapper {
        position: relative;
        width: 50px;
        height: 50px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .mode-card .icon-container {
        width: 50px;
        height: 50px;
        position: relative;
      }

      .mode-card .draw-path {
        fill: var(--icon-color); 
        stroke: var(--icon-color); 
        stroke-width: 0; 
        stroke-dasharray: 2000; 
        stroke-dashoffset: 0;
        transition: fill 0.4s ease, stroke-width 0.4s ease;
      }

      .mode-card:hover .draw-path {
        fill: transparent; 
        stroke-width: 12px; 
        animation: drawLine 2s ease-in-out forwards;
      }

      @keyframes drawLine {
        0% { stroke-dashoffset: 2000; }
        100% { stroke-dashoffset: 0; }
      }

      .mode-card .star-dot {
        opacity: 0; 
        transition: opacity 0.5s ease 0.2s; 
      }

      .mode-card:hover .star-dot {
        opacity: 1 !important;
      }
      
      .mode-card h3 {
        margin: 0 0 16px 0;
        font-family: var(--font-serif);
        font-size: 1.25rem;
        color: var(--text);
        font-weight: 600;
      }
      .mode-card p {
        margin: 0;
        font-size: 0.95rem;
        color: var(--muted);
        line-height: 1.6;
        text-align: left;
        width: 100%;
      }

      @media (max-width: 768px) {
        .mode-selection-grid {
           grid-template-columns: 1fr;
           gap: 24px;
        }
        .section.splash .container {
           max-width: 100%;
        }
        .intro-showcase {
          gap: 16px;
        }
      }

      /* Night Sea Theme Specifics */
      .night-sea-title-container {
        position: fixed;
        /* Adjusted top position for better vertical balance */
        top: 22%;
        left: 0;
        width: 100%;
        text-align: center;
        z-index: 20;
        pointer-events: none;
        opacity: 0;
        animation: fadeIn 2s ease-out forwards;
      }
      .night-sea-subtitle {
        font-family: 'Cinzel', serif;
        font-size: 0.9rem;
        color: var(--muted);
        letter-spacing: 0.5rem;
        margin-top: 1rem;
        opacity: 0.7;
        text-transform: uppercase;
      }
      
      .ocean-perspective {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        z-index: 0; 
        pointer-events: none;
        overflow: hidden;
        background: none;
      }
      
      .ocean-plane {
        width: 100%; height: 100%; position: absolute; top: 0; left: 0;
      }

      .ocean-vignette {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background: radial-gradient(ellipse at bottom center, transparent 30%, rgba(0,0,0,0.2) 70%, #000 100%);
        pointer-events: none; z-index: 2;
      }

      .constellation-map {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        z-index: 30;
      }
      .star-node {
        position: absolute;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.27);
      }
      .star-node:hover { transform: scale(1.1); }
      .star-node.active { transform: scale(1.15); }
      
      .constellation-svg-wrapper {
        width: 120px; height: 120px;
        filter: drop-shadow(0 0 8px var(--node-color));
      }
      .constellation-svg { width: 100%; height: 100%; overflow: visible; }
      
      .star-node .draw-path {
        stroke-dasharray: 1000; 
        stroke-dashoffset: 1000;
        transition: stroke-dashoffset 2s ease-in-out; 
        opacity: 0.3;
        stroke-width: 1.5;
        fill: none; 
      }
      
      .star-node:hover .draw-path, .star-node.active .draw-path {
        stroke-dashoffset: 0; opacity: 1;
      }
      
      .star-dot { transition: r 0.3s; }
      .star-node:hover .star-dot { r: 3; }
      
      .star-label-container {
        margin-top: 10px; text-align: center; opacity: 0.6; transition: opacity 0.3s;
      }
      .star-node:hover .star-label-container, .star-node.active .star-label-container { opacity: 1; }
      .star-label-main {
        font-family: var(--font-serif); font-size: 1.1rem; color: #fff; margin-bottom: 4px; text-shadow: 0 0 10px #000;
      }
      .star-label-sub {
        font-family: 'Cinzel', serif; font-size: 0.7rem; color: var(--node-color); letter-spacing: 1px; text-transform: uppercase;
      }

      .node-projection { top: 40%; left: 20%; }
      .node-dream { top: 55%; left: 50%; transform: translateX(-50%); }
      .node-imagination { top: 40%; right: 20%; }
      
      @media (max-width: 768px) {
         .night-sea-title-container { position: relative; top: auto; padding-top: 40px; margin-bottom: 20px; }
         .constellation-map { position: relative; height: 400px; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 40px; }
         .star-node { position: relative; top: auto !important; left: auto !important; right: auto !important; transform: none !important; }
         .ocean-perspective { height: 40vh; }
      }

      .input-section {
        background: rgba(21, 25, 34, 0.75);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        padding: 32px;
        width: 100%;
        max-width: 800px; 
        margin: 40px auto 0; 
        box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        /* Use a fade-in-down animation for smoother entry */
        animation: fadeInDown 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
      }
      
      @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-20px); } 
        to { opacity: 1; transform: translateY(0); } 
      }

      textarea {
        width: 100%; height: 160px;
        background: rgba(12, 16, 23, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 8px; padding: 16px;
        font-family: 'Inter', sans-serif; font-size: 1rem; color: var(--text);
        resize: none; outline: none; transition: all 0.3s; line-height: 1.6;
      }
      textarea:focus {
        border-color: rgba(255, 255, 255, 0.7); 
        background: rgba(12, 16, 23, 0.9);
      }

      .voice-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.05);
        color: white;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s;
        backdrop-filter: blur(4px);
        flex-shrink: 0;
      }
      .voice-button:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-1px);
      }
      .voice-button:active {
        transform: translateY(0);
      }
      .voice-button.recording {
        background: rgba(200, 220, 255, 0.2);
        border-color: rgba(200, 220, 255, 0.5);
        color: rgb(200, 220, 255);
        animation: recordingPulse 2s ease-in-out infinite;
      }
      .voice-button.recording:hover {
        background: rgba(200, 220, 255, 0.25);
      }

      @keyframes recordingPulse {
        0%, 100% { 
          box-shadow: 0 0 0 0 rgba(200, 220, 255, 0.5);
        }
        50% { 
          box-shadow: 0 0 0 8px rgba(200, 220, 255, 0);
        }
      }

      .analyze-button {
        background: var(--text); color: #000;
        font-family: var(--font-serif); font-weight: 600;
        padding: 12px 36px; border-radius: 999px; border: none;
        font-size: 1rem; cursor: pointer; transition: all 0.3s;
        box-shadow: 0 0 20px rgba(255,255,255,0.1);
      }
      .analyze-button:hover:not(:disabled) { transform: scale(1.05); box-shadow: 0 0 30px rgba(255,255,255,0.3); }
      .analyze-button:disabled { opacity: 0.5; cursor: not-allowed; }

      .chat-section {
        display: flex; flex-direction: column; height: 100vh; width: 100%;
        max-width: 800px; margin: 0 auto; position: relative;
        background: rgba(12, 16, 23, 0.8);
      }
      .chat-header {
        padding: 20px 24px; border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        display: flex; align-items: center; background: rgba(12, 16, 23, 0.95); z-index: 10;
      }
      .chat-log {
        flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; gap: 24px; scroll-behavior: smooth; scrollbar-width: none;
      }
      .chat-log::-webkit-scrollbar { display: none; }
      .bubble { max-width: 90%; padding: 16px 20px; border-radius: 12px; line-height: 1.8; position: relative; font-size: 1rem; }
      .user-bubble { align-self: flex-end; background: var(--text); color: #0c0f14; border-bottom-right-radius: 4px; font-family: 'Inter', sans-serif; }
      .model-bubble { align-self: flex-start; background: var(--card); border: 1px solid rgba(255, 255, 255, 0.08); color: var(--text); border-bottom-left-radius: 4px; font-family: 'Inter', system-ui, sans-serif; }
      
      .chat-input-area { padding: 20px; background: rgba(12, 16, 23, 0.95); border-top: 1px solid rgba(255,255,255,0.08); }
      .chat-input-wrapper { display: flex; gap: 12px; background: rgba(255,255,255,0.05); padding: 8px 12px; border-radius: 24px; border: 1px solid rgba(255,255,255,0.1); }
      .chat-input-wrapper input { flex: 1; background: transparent; border: none; color: white; font-size: 1rem; outline: none; font-family: 'Inter', sans-serif; }
      .chat-input-wrapper button { background: var(--text); color: black; width: 36px; height: 36px; border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
      .chat-input-wrapper button:disabled { opacity: 0.5; cursor: default; }

      .analysis-card { background: rgba(20, 20, 25, 0.8); border: 1px solid rgba(255,255,255,0.08); border-radius: 8px; overflow: hidden; margin-top: 8px; width: 100%; max-width: 600px; }
      .analysis-card-header { padding: 12px 16px; background: rgba(255,255,255,0.03); font-family: var(--font-serif); font-weight: 600; display: flex; align-items: center; gap: 8px; font-size: 0.95rem; }
      .analysis-card-body { padding: 16px; font-size: 0.95rem; line-height: 1.8; color: rgba(255,255,255,0.9); }

      .depth-meter { height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden; }
      .depth-meter-fill { height: 100%; background: var(--mystic-gold); transition: width 0.5s ease; }

      .atlas-nav-button { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.1); color: white; width: 48px; height: 48px; font-size: 1.2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; backdrop-filter: blur(4px); }
      .atlas-nav-button:hover { background: rgba(255,255,255,0.2); }
      
      .atlas-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
        gap: 24px; 
        width: 100%; 
        padding-bottom: 40px;
        justify-content: center; /* Center the grid items if they don't fill the row */
      }
      
      .atlas-card { height: 380px; perspective: 1000px; cursor: pointer; }
      .atlas-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1); transform-style: preserve-3d; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
      .atlas-card.is-flipped .atlas-card-inner { transform: rotateY(180deg); }
      .atlas-card-front, .atlas-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; padding: 24px; border: 1px solid rgba(255,255,255,0.1); }
      .atlas-card-front { background-color: #1a1e26; background-size: cover; background-position: center; }
      .atlas-card-back { background-color: #1a1e26; transform: rotateY(180deg); justify-content: flex-start; align-items: flex-start; text-align: left; padding: 24px; overflow-y: auto; }
      .insight-item { background: rgba(255,255,255,0.05); border-left: 2px solid var(--mystic-gold); padding: 10px; margin-bottom: 12px; border-radius: 0 4px 4px 0; font-size: 0.85rem; line-height: 1.5; color: rgba(255,255,255,0.8); }
      .insight-date { font-size: 0.7rem; color: var(--muted); display: block; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 1px; }

      .error-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); z-index: 100; display: flex; align-items: center; justify-content: center; padding: 24px; }
      .error-card { background: #1a1e26; border: 1px solid rgba(212, 106, 106, 0.5); padding: 32px; border-radius: 16px; text-align: center; max-width: 400px; box-shadow: 0 0 40px rgba(212, 106, 106, 0.1); }
      .error-icon { font-size: 3rem; color: var(--error-red); margin-bottom: 16px; }
      .error-message { color: var(--text); margin-bottom: 24px; white-space: pre-line; line-height: 1.6; }
      .error-buttons { display: flex; gap: 12px; justify-content: center; }
      .error-btn { padding: 8px 24px; border-radius: 4px; border: none; font-weight: 600; cursor: pointer; }
      .error-btn.primary { background: var(--error-red); color: white; }
      .error-btn.secondary { background: transparent; border: 1px solid var(--muted); color: var(--muted); }

    </style>
  <link rel="stylesheet" href="/index.css">
</head>
  <body>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>